<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>&Uumlbersicht Kurse</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="http://localhost:3000/files/choices.js"></script>
    <script src="http://localhost:3000/files/menu.js"></script>
</head>
<body>
<div id="menu"></div>
<div class="container" id="edit course">
    <div class="row">
        <form id="courseForm">
            <div id="choice"></div>
            <hr>
            <div class="form-group md-6">
                <h3>Themen</h3>
                <div id="themes"></div>
            </div>
            <hr>
            <div class="form-group md-6">
                <h3>Tests</h3>
                <div id="tests"></div>
            </div>
            <hr>
            <div class="form-group md-6">
                <h3>Teilnehmer</h3>
                <div id="participant"></div>
            </div>
            <hr>
            <button type="submit" class="btn btn-primary mb-2">Kurs l&oumlschen</button>
        </form>
    </div>
</div>
</body>
<style>

</style>
<script>
    $changeMethodBody = function (coursename) {
        $.get("http://localhost:3000/course/?coursename=\"" + coursename + "\"", function (students) {
            var unorderedList = "<ul class=\"list-group\">";
            for (var pos in students) {
                //get alle files from this theme
                unorderedList += "<li class=\"list-group-item\">" + students[pos].student + "</li>";
            }
            unorderedList += "</ul>";
            $("#participant").html(unorderedList);
        });

        $.get("http://localhost:3000/themes/?coursename=\"" + coursename + "\"", function (themes) {
            var unorderedList = "<ul class=\"list-group\">";
            for (var themePos in themes) {
                unorderedList += "<li class=\"list-group-item\" id='file" + themePos + "'>" + themes[themePos].themename + "</li>";
            }
            unorderedList += "</ul>";
            $("#themes").html(unorderedList);
            for (var themePos in themes) {
                $updateFileLinks(coursename, themes[themePos].themename, themePos);
            }
        });

        $.get("http://localhost:3000/test/?coursename=\"" + coursename + "\"", function (tests) {
            $("#tests").html(tests);
        });

        $("#courseForm").submit(function (event) {
            $.ajax({
                url: "http://localhost:3000/course/?coursename=\"" + coursename + "\"",
                type: 'DELETE'
            });
        });

    }
    $updateFileLinks = function (coursename, themename, fileId) {
        $.get("http://localhost:3000/files/?coursename=\"" + coursename + "\"&themename=\""
            + themename + "\"", function (files) {
            if (files.length > 0) {
                var fileList = themename + "<ul class=\"list-group\">";
                for (var filePos in files) {
                    //get alle files from this theme
                    var filename = files[filePos].filename;
                    fileList +=
                        "<li class=\"list-group-item\">" +
                        "<a href=\"http://localhost:3000/files/" + filename + "\">" + filename + "</a>" +
                        "</li>";
                }
                fileList += "</ul>";
                var id = "#file" + fileId;
                $(id).html(fileList);
            }
        });
    }
</script>
</html>